<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>11.2.7. Fast QCP RMSD structure alignment — MDAnalysis.lib.qcprot &mdash; MDAnalysis 0.16.0-dev0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.16.0-dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.16.0-dev0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.16.0-dev0 documentation" href="../../index.html" />
    <link rel="up" title="11. Library functions — MDAnalysis.lib" href="../lib_modules.html" />
    <link rel="next" title="11.2.8. Helper functions — MDAnalysis.lib.util" href="util.html" />
    <link rel="prev" title="11.2.6. Homogeneous Transformation Matrices and Quaternions — MDAnalysis.lib.transformations" href="transformations.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="util.html" title="11.2.8. Helper functions — MDAnalysis.lib.util"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="transformations.html" title="11.2.6. Homogeneous Transformation Matrices and Quaternions — MDAnalysis.lib.transformations"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.16.0-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../lib_modules.html" accesskey="U">11. Library functions &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.lib</span></code></a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">11.2.7. Fast QCP RMSD structure alignment &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.lib.qcprot</span></code></a><ul>
<li><a class="reference internal" href="#functions">11.2.7.1. Functions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="transformations.html"
                        title="previous chapter">11.2.6. Homogeneous Transformation Matrices and Quaternions &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.lib.transformations</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="util.html"
                        title="next chapter">11.2.8. Helper functions &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.lib.util</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/documentation_pages/lib/qcprot.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.lib.qcprot"></span><div class="section" id="fast-qcp-rmsd-structure-alignment-mdanalysis-lib-qcprot">
<h1>11.2.7. Fast QCP RMSD structure alignment &#8212; <a class="reference internal" href="#module-MDAnalysis.lib.qcprot" title="MDAnalysis.lib.qcprot"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.lib.qcprot</span></code></a><a class="headerlink" href="#fast-qcp-rmsd-structure-alignment-mdanalysis-lib-qcprot" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Joshua L. Adelman, University of Pittsburgh</td>
</tr>
<tr class="field-even field"><th class="field-name">Author:</th><td class="field-body">Robert R. Delgado, Cornell University and Arizona State University</td>
</tr>
<tr class="field-odd field"><th class="field-name">Contact:</th><td class="field-body"><a class="reference external" href="mailto:jla65&#37;&#52;&#48;pitt&#46;edu">jla65<span>&#64;</span>pitt<span>&#46;</span>edu</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2011, 2016</td>
</tr>
<tr class="field-odd field"><th class="field-name">Licence:</th><td class="field-body">BSD</td>
</tr>
</tbody>
</table>
<p><a class="reference external" href="https://github.com/synapticarbors/pyqcprot">PyQCPROT</a> is a python/cython implementation of Douglas Theobald&#8217;s QCP
method for calculating the minimum RMSD between two structures
<a class="reference internal" href="../references.html#theobald2005" id="id1">[Theobald2005]</a> and determining the optimal least-squares rotation
matrix <a class="reference internal" href="../references.html#liu2010" id="id2">[Liu2010]</a>.</p>
<p>A full description of the method, along with the original C implementation can
be found at <a class="reference external" href="http://theobald.brandeis.edu/qcp/">http://theobald.brandeis.edu/qcp/</a></p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="#MDAnalysis.lib.qcprot.CalcRMSDRotationalMatrix" title="MDAnalysis.lib.qcprot.CalcRMSDRotationalMatrix"><code class="xref py py-func docutils literal"><span class="pre">CalcRMSDRotationalMatrix()</span></code></a> function is used in
<a class="reference internal" href="../analysis/align.html#module-MDAnalysis.analysis.align" title="MDAnalysis.analysis.align"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.analysis.align</span></code></a> and
<code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.analysis.rmsd</span></code>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.16.0: </span>Call signatures were changed to directly interface with MDAnalysis
coordinate arrays: shape (N, 3)</p>
</div>
<p class="rubric">References</p>
<p>If you use this QCP rotation calculation method in a publication, please
reference:</p>
<table class="docutils citation" frame="void" id="theobald2005" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Theobald2005]</a></td><td>Douglas L. Theobald (2005)
&#8220;Rapid calculation of RMSD using a quaternion-based characteristic
polynomial.&#8221;  Acta Crystallographica A 61(4):478-480.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="liu2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Liu2010]</a></td><td>Pu Liu, Dmitris K. Agrafiotis, and Douglas L. Theobald (2010)
&#8220;Fast determination of the optimal rotational matrix for macromolecular
superpositions.&#8221;  J. Comput. Chem. 31, 1561-1563.</td></tr>
</tbody>
</table>
<div class="section" id="functions">
<h2>11.2.7.1. Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<p>Users will typically use the <a class="reference internal" href="#MDAnalysis.lib.qcprot.CalcRMSDRotationalMatrix" title="MDAnalysis.lib.qcprot.CalcRMSDRotationalMatrix"><code class="xref py py-func docutils literal"><span class="pre">CalcRMSDRotationalMatrix()</span></code></a> function.</p>
<dl class="function">
<dt id="MDAnalysis.lib.qcprot.CalcRMSDRotationalMatrix">
<code class="descclassname">MDAnalysis.lib.qcprot.</code><code class="descname">CalcRMSDRotationalMatrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.qcprot.CalcRMSDRotationalMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the RMSD &amp; rotational matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ref</strong> (<em>ndarray, np.float64_t</em>) &#8211; reference structure coordinates</li>
<li><strong>conf</strong> (<em>ndarray, np.float64_t</em>) &#8211; condidate structure coordinates</li>
<li><strong>N</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; size of the system</li>
<li><strong>rot</strong> (<em>ndarray, np.float64_t</em>) &#8211; array to store rotation matrix. Must be flat</li>
<li><strong>weights</strong> (<em>ndarray, npfloat64_t (optional)</em>) &#8211; weights for each component</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>rmsd</strong> (<em>float</em>) &#8211;
RMSD value</li>
<li><strong>.. versionchanged</strong> (<em>: 0.16.0</em>) &#8211;
Array size changed from 3xN to Nx3.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="MDAnalysis.lib.qcprot.InnerProduct">
<code class="descclassname">MDAnalysis.lib.qcprot.</code><code class="descname">InnerProduct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.qcprot.InnerProduct" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the inner product of two structures.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>ndarray np.float64_t</em>) &#8211; result inner product array, modified in place</li>
<li><strong>coords1</strong> (<em>ndarray np.float64_t</em>) &#8211; reference structure</li>
<li><strong>coord2</strong> (<em>ndarray np.float64_t</em>) &#8211; candidate structure</li>
<li><strong>N</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; size of system</li>
<li><strong>weights</strong> (<em>ndarray np.float64_t (optional)</em>) &#8211; use to calculate weighted inner product</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>E0</strong> (<em>float</em>)</li>
<li>0.5 * (G1 + G2), can be used as input for <a class="reference internal" href="#MDAnalysis.lib.qcprot.FastCalcRMSDAndRotation" title="MDAnalysis.lib.qcprot.FastCalcRMSDAndRotation"><code class="xref py py-func docutils literal"><span class="pre">FastCalcRMSDAndRotation()</span></code></a></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li>You MUST center the structures, coords1 and coords2, before calling this
function.</li>
<li>Coordinates are stored as Nx3 arrays (as everywhere else in MDAnalysis).</li>
</ol>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.16.0: </span>Array size changed from 3xN to Nx3.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="MDAnalysis.lib.qcprot.FastCalcRMSDAndRotation">
<code class="descclassname">MDAnalysis.lib.qcprot.</code><code class="descname">FastCalcRMSDAndRotation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.lib.qcprot.FastCalcRMSDAndRotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the RMSD, and/or the optimal rotation matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rot</strong> (<em>ndarray np.float64_t</em>) &#8211; result rotation matrix, modified inplace</li>
<li><strong>A</strong> (<em>ndarray np.float64_t</em>) &#8211; the inner product of two structures</li>
<li><strong>E0</strong> (<em>float64</em>) &#8211; 0.5 * (G1 + G2)</li>
<li><strong>N</strong> (<a class="reference external" href="http://docs.python.org/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; size of the system</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rmsd</strong> &#8211;
RMSD value for two structures</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="http://docs.python.org/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.16.0: </span>Array sized changed from 3xN to Nx3.</p>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="util.html" title="11.2.8. Helper functions — MDAnalysis.lib.util"
             >next</a> |</li>
        <li class="right" >
          <a href="transformations.html" title="11.2.6. Homogeneous Transformation Matrices and Quaternions — MDAnalysis.lib.transformations"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.16.0-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../lib_modules.html" >11. Library functions &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.lib</span></code></a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Wouter Boomsma, Bart Bruininks, Sébastien Buchoux, David Caplan, Matthieu Chavent, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Max Linke, Jinju Lu, Robert McGibbon, Manuel Nuno Melo, Fiona Naughton, Alex Nesterenko, Hai Nguyen, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Vedant Rathore, Tyler Reddy, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Xiki Tempula, Matteo Tiberti, Isaac Virshup, Zhuyi Xue, and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>