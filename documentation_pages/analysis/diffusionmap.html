<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.9.1. Diffusion map — MDAnalysis.analysis.diffusionmap &mdash; MDAnalysis 0.15.1-dev0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.15.1-dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.15.1-dev0 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="top" title="MDAnalysis 0.15.1-dev0 documentation" href="../../index.html" />
    <link rel="up" title="3. Analysis modules" href="../analysis_modules.html" />
    <link rel="next" title="4. Topology modules" href="../topology_modules.html" />
    <link rel="prev" title="3.8.3. Water dynamics analysis — MDAnalysis.analysis.waterdynamics" href="waterdynamics.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../topology_modules.html" title="4. Topology modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="waterdynamics.html" title="3.8.3. Water dynamics analysis — MDAnalysis.analysis.waterdynamics"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.15.1-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../analysis_modules.html" accesskey="U">3. Analysis modules</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/mdanalysis-logo-200x150.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.9.1. Diffusion map &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.diffusionmap</span></code></a><ul>
<li><a class="reference internal" href="#diffusion-map-tutorial">3.9.1.1. Diffusion Map tutorial</a></li>
<li><a class="reference internal" href="#distance-matrix-tutorial">3.9.1.2. Distance Matrix tutorial</a></li>
<li><a class="reference internal" href="#classes">3.9.1.3. Classes</a></li>
<li><a class="reference internal" href="#for-more-information">3.9.1.4. For more information</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="waterdynamics.html"
                        title="previous chapter">3.8.3. Water dynamics analysis &#8212; <code class="docutils literal"><span class="pre">MDAnalysis.analysis.waterdynamics</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../topology_modules.html"
                        title="next chapter">4. Topology modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/documentation_pages/analysis/diffusionmap.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.analysis.diffusionmap"></span><div class="section" id="diffusion-map-mdanalysis-analysis-diffusionmap">
<h1>3.9.1. Diffusion map &#8212; <a class="reference internal" href="#module-MDAnalysis.analysis.diffusionmap" title="MDAnalysis.analysis.diffusionmap"><code class="xref py py-mod docutils literal"><span class="pre">MDAnalysis.analysis.diffusionmap</span></code></a><a class="headerlink" href="#diffusion-map-mdanalysis-analysis-diffusionmap" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Authors:</th><td class="field-body">Eugen Hruska, John Detlefs</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2016</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">GNU Public License v2</td>
</tr>
</tbody>
</table>
<p>This module contains the non-linear dimension reduction method diffusion map.
The eigenvectors of a diffusion matrix represent the &#8216;collective coordinates&#8217;
of a molecule; the largest eigenvalues are the more dominant collective
coordinates. Assigning phyiscal meaning to the &#8216;collective coordinates&#8217; is a
fundamentally difficult problem. The time complexity of the diffusion map is
<span class="math">\(O(N^3)\)</span>, where N is the number of frames in the trajectory, and the in-memory
storage complexity is <span class="math">\(O(N^2)\)</span>. Instead of a single trajectory a sample of
protein structures can be used. The sample should be equiblibrated, at least
locally. The order of the sampled structures in the trajectory is irrelevant.</p>
<p>The <a class="reference internal" href="#diffusion-map-tutorial"><span>Diffusion Map tutorial</span></a> shows how to use diffusion map for dimension
reduction.</p>
<p>More details about diffusion maps are in <a class="reference internal" href="#delaporte1" id="id1">[deLaPorte1]</a>, <a class="reference internal" href="#lafon1" id="id2">[Lafon1]</a> ,
<a class="reference internal" href="#ferguson1" id="id3">[Ferguson1]</a>, and <a class="reference internal" href="#clementi1" id="id4">[Clementi1]</a>.</p>
<div class="section" id="diffusion-map-tutorial">
<span id="id5"></span><h2>3.9.1.1. Diffusion Map tutorial<a class="headerlink" href="#diffusion-map-tutorial" title="Permalink to this headline">¶</a></h2>
<p>The example uses files provided as part of the MDAnalysis test suite
(in the variables <code class="xref py py-data docutils literal"><span class="pre">PSF</span></code> and
<code class="xref py py-data docutils literal"><span class="pre">DCD</span></code>). This tutorial shows how to use the
Diffusion Map class.</p>
<p>First load all modules and test data</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="kn">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis.analysis.diffusionmap</span> <span class="kn">as</span> <span class="nn">diffusionmap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span>
</pre></div>
</div>
<p>Given a universe or atom group, we can create and eigenvalue decompose
the Diffusion Matrix from that trajectory using <a class="reference internal" href="#MDAnalysis.analysis.diffusionmap.DiffusionMap" title="MDAnalysis.analysis.diffusionmap.DiffusionMap"><code class="xref py py-class docutils literal"><span class="pre">DiffusionMap</span></code></a>:: and get
the corresponding eigenvalues and eigenvectors.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span><span class="n">DCD</span><span class="p">)</span>
</pre></div>
</div>
<p>We leave determination of the appropriate scale parameter epsilon to the user,
<a class="reference internal" href="#clementi1" id="id6">[Clementi1]</a> uses a complex method involving the k-nearest-neighbors of a
trajectory frame, whereas others simple use a trial-and-error approach with
a constant epsilon. Currently, the constant epsilon method is implemented
by MDAnalysis.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dmap</span> <span class="o">=</span> <span class="n">diffusionmap</span><span class="o">.</span><span class="n">DiffusionMap</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;backbone&#39;</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmap</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>From here we can perform an embedding onto the k dominant eigenvectors. The
non-linearity of the map means there is no explicit relationship between the
lower dimensional space and our original trajectory. However, this is an
isometry (distance preserving map), which means that points close in the lower
dimensional space are close in the higher-dimensional space and vice versa.
In order to embed into the most relevant low-dimensional space, there should
exist some number of dominant eigenvectors, whose corresponding eigenvalues
diminish at a constant rate until falling off, this is referred to as a
spectral gap and should be somewhat apparent for a system at equilibrium with a
high number of frames.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span> <span class="c1"># first cell of  a jupyter notebook should contain: %matplotlib inline</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">upper_limit</span> <span class="o">=</span> <span class="c1"># some reasonably high number less than the n_eigenvectors</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dmap</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">[:</span><span class="n">upper_limit</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span> <span class="o">=</span><span class="s1">&#39;eigenvalue index&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;eigenvalue&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span> <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<p>From here we can transform into the diffusion space</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_eigenvectors</span> <span class="o">=</span> <span class="c1"># some number less than the number of frames after</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># inspecting for the spectral gap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fit</span> <span class="o">=</span> <span class="n">dmap</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">num_eigenvectors</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>It can be difficult to interpret the data, and is left as a task
for the user. The <cite>diffusion distance</cite> between frames i and j is best
approximated by the euclidean distance  between rows i and j of
self.diffusion_space.</p>
</div>
<div class="section" id="distance-matrix-tutorial">
<span id="id7"></span><h2>3.9.1.2. Distance Matrix tutorial<a class="headerlink" href="#distance-matrix-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Often a, a custom distance matrix could be useful for local
epsilon determination or other manipulations on the diffusion
map method. The <a class="reference internal" href="#MDAnalysis.analysis.diffusionmap.DistanceMatrix" title="MDAnalysis.analysis.diffusionmap.DistanceMatrix"><code class="xref py py-class docutils literal"><span class="pre">DistanceMatrix</span></code></a> exists in
<a class="reference internal" href="#module-MDAnalysis.analysis.diffusionmap" title="MDAnalysis.analysis.diffusionmap"><code class="xref py py-mod docutils literal"><span class="pre">diffusionmap</span></code></a> and can be passed
as an initialization argument for <a class="reference internal" href="#MDAnalysis.analysis.diffusionmap.DiffusionMap" title="MDAnalysis.analysis.diffusionmap.DiffusionMap"><code class="xref py py-class docutils literal"><span class="pre">DiffusionMap</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="kn">as</span> <span class="nn">mda</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">MDAnalysis.analysis.diffusionmap</span> <span class="kn">as</span> <span class="nn">diffusionmap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">MDAnalysis.tests.datafiles</span> <span class="kn">import</span> <span class="n">PSF</span><span class="p">,</span> <span class="n">DCD</span>
</pre></div>
</div>
<p>Now create the distance matrix and pass it as an argument to
<a class="reference internal" href="#MDAnalysis.analysis.diffusionmap.DiffusionMap" title="MDAnalysis.analysis.diffusionmap.DiffusionMap"><code class="xref py py-class docutils literal"><span class="pre">DiffusionMap</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="n">PSF</span><span class="p">,</span><span class="n">DCD</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_matrix</span> <span class="o">=</span> <span class="n">diffusionmap</span><span class="o">.</span><span class="n">DistanceMatrix</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist_matrix</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmap</span> <span class="o">=</span> <span class="n">diffusionmap</span><span class="o">.</span><span class="n">DiffusionMap</span><span class="p">(</span><span class="n">dist_matrix</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dmap</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="classes">
<h2>3.9.1.3. Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="MDAnalysis.analysis.diffusionmap.DiffusionMap">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.diffusionmap.</code><code class="descname">DiffusionMap</code><span class="sig-paren">(</span><em>u</em>, <em>epsilon=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/diffusionmap.html#DiffusionMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.diffusionmap.DiffusionMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-linear dimension reduction method</p>
<p>Dimension reduction with diffusion mapping of selected structures in a
trajectory.</p>
<dl class="attribute">
<dt id="MDAnalysis.analysis.diffusionmap.DiffusionMap.eigenvalues">
<code class="descname">eigenvalues</code><a class="headerlink" href="#MDAnalysis.analysis.diffusionmap.DiffusionMap.eigenvalues" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array (n_frames,)</em></p>
<p>Eigenvalues of the diffusion map</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.diffusionmap.DiffusionMap.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/diffusionmap.html#DiffusionMap.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.diffusionmap.DiffusionMap.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs an anisotropic diffusion kernel and performs eigenvalue
decomposition on it.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.diffusionmap.DiffusionMap.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>n_eigenvectors</em>, <em>time</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/diffusionmap.html#DiffusionMap.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.diffusionmap.DiffusionMap.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an embedding of a frame into the eigenvectors representing
the collective coordinates.</p>
</dd></dl>

<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>u</strong> (<em>MDAnalysis Universe or DistanceMatrix object</em>) &#8211; Can be a Universe, in which case one must supply kwargs for the
initialization of a DistanceMatrix. Otherwise, this can be a
DistanceMatrix already initialized. Either way, this will be made
into a diffusion kernel.</li>
<li><strong>epsilon</strong> (<em>Float</em>) &#8211; Specifies the method used for the choice of scale parameter in the
diffusion map. More information in <a class="reference internal" href="#lafon1" id="id8">[Lafon1]</a>, <a class="reference internal" href="#ferguson1" id="id9">[Ferguson1]</a> and
<a class="reference internal" href="#clementi1" id="id10">[Clementi1]</a>, Default: 1.</li>
<li><strong>**kwargs</strong> &#8211; <p>Parameters to be passed for the initialization of a
<a class="reference internal" href="#MDAnalysis.analysis.diffusionmap.DistanceMatrix" title="MDAnalysis.analysis.diffusionmap.DistanceMatrix"><code class="xref py py-class docutils literal"><span class="pre">DistanceMatrix</span></code></a>.</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="MDAnalysis.analysis.diffusionmap.DistanceMatrix">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.diffusionmap.</code><code class="descname">DistanceMatrix</code><span class="sig-paren">(</span><em>u</em>, <em>select='all'</em>, <em>metric=&lt;function rmsd&gt;</em>, <em>cutoff=-4.0</em>, <em>weights=None</em>, <em>start=None</em>, <em>stop=None</em>, <em>step=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/diffusionmap.html#DistanceMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.diffusionmap.DistanceMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the pairwise distance between each frame in a trajectory
using a given metric</p>
<p>A distance matrix can be initialized on its own and used as an
initialization argument in <a class="reference internal" href="#MDAnalysis.analysis.diffusionmap.DiffusionMap" title="MDAnalysis.analysis.diffusionmap.DiffusionMap"><code class="xref py py-class docutils literal"><span class="pre">DiffusionMap</span></code></a>. Refer to the
<a class="reference internal" href="#distance-matrix-tutorial"><span>Distance Matrix tutorial</span></a> for a demonstration.</p>
<dl class="attribute">
<dt id="MDAnalysis.analysis.diffusionmap.DistanceMatrix.atoms">
<code class="descname">atoms</code><a class="headerlink" href="#MDAnalysis.analysis.diffusionmap.DistanceMatrix.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p><em>AtomGroup</em></p>
<p>Selected atoms in trajectory subject to dimension reduction</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.diffusionmap.DistanceMatrix.dist_matrix">
<code class="descname">dist_matrix</code><a class="headerlink" href="#MDAnalysis.analysis.diffusionmap.DistanceMatrix.dist_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array, (n_frames, n_frames)</em></p>
<p>Array of all possible ij metric distances between frames in trajectory.
This matrix is symmetric with zeros on the diagonal.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.diffusionmap.DistanceMatrix.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/diffusionmap.html#DistanceMatrix.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.diffusionmap.DistanceMatrix.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the <cite>dist_matrix</cite> to a given filename</p>
</dd></dl>

<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>u</strong> (universe <cite>~MDAnalysis.core.AtomGroup.Universe</cite>) &#8211; The MD Trajectory for dimension reduction, remember that
computational cost of eigenvalue decomposition
scales at O(N^3) where N is the number of frames.
Cost can be reduced by increasing step interval or specifying a
start and stop.</li>
<li><strong>select</strong> (<em>str, optional</em>) &#8211; Any valid selection string for
<a class="reference internal" href="../core/AtomGroup.html#MDAnalysis.core.AtomGroup.AtomGroup.select_atoms" title="MDAnalysis.core.AtomGroup.AtomGroup.select_atoms"><code class="xref py py-meth docutils literal"><span class="pre">select_atoms()</span></code></a>
This selection of atoms is used to calculate the RMSD between
different frames. Water should be excluded.</li>
<li><strong>metric</strong> (<em>function, optional</em>) &#8211; Maps two numpy arrays to a float, is positive definite and
symmetric. The API for a metric requires that the arrays must have
equal length, and that the function should have weights as an
optional argument. Weights give each index value its own weight for
the metric calculation over the entire arrays. Default: metric is
set to rms.rmsd().</li>
<li><strong>cutoff</strong> (<em>float, optional</em>) &#8211; Specify a given cutoff for metric values to be considered equal,
Default: 1EO-5</li>
<li><strong>weights</strong> (<em>array, optional</em>) &#8211; Weights to be given to coordinates for metric calculation</li>
<li><strong>start</strong> (<em>int, optional</em>) &#8211; First frame of trajectory to analyse, Default: 0</li>
<li><strong>stop</strong> (<em>int, optional</em>) &#8211; Last frame of trajectory to analyse, Default: -1</li>
<li><strong>step</strong> (<em>int, optional</em>) &#8211; Step between frames to analyse, Default: 1</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">References</p>
<p>If you use this Dimension Reduction method in a publication, please
cite:</p>
<table class="docutils citation" frame="void" id="lafon1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Lafon1]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id8">2</a>)</em> </td></tr>
</tbody>
</table>
<p>Coifman, Ronald R., Lafon, Stephane Diffusion maps. Appl. Comput. Harmon.
Anal. 21, 5–30  (2006).</p>
</div>
<div class="section" id="for-more-information">
<h2>3.9.1.4. For more information<a class="headerlink" href="#for-more-information" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="delaporte1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[deLaPorte1]</a></td><td></td></tr>
</tbody>
</table>
<p>J. de la Porte, B. M. Herbst, W. Hereman, S. J. van der Walt.
An Introduction to Diffusion Maps.</p>
<table class="docutils citation" frame="void" id="clementi1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Clementi1]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id6">2</a>, <a class="fn-backref" href="#id10">3</a>)</em> </td></tr>
</tbody>
</table>
<p>Rohrdanz, M. A, Zheng, W, Maggioni, M, &amp; Clementi, C.
Determination of reaction coordinates via locally scaled
diffusion map. J. Chem. Phys. 134, 124116 (2011).</p>
<table class="docutils citation" frame="void" id="ferguson1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Ferguson1]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id9">2</a>)</em> </td></tr>
</tbody>
</table>
<p>Ferguson, A. L.; Panagiotopoulos, A. Z.; Kevrekidis, I. G.
Debenedetti,  P. G. Nonlinear dimensionality reduction in molecular simulation:
The diffusion map approach  Chem. Phys. Lett. 509, 1−11 (2011)</p>
<p><a class="reference internal" href="../lib/qcprot.html#theobald2005" id="id13">[Theobald2005]</a> to calculate the root mean square distance (RMSD) between
two coordinate sets (as implemented
in <a class="reference internal" href="../lib/qcprot.html#MDAnalysis.lib.qcprot.CalcRMSDRotationalMatrix" title="MDAnalysis.lib.qcprot.CalcRMSDRotationalMatrix"><code class="xref py py-func docutils literal"><span class="pre">MDAnalysis.lib.qcprot.CalcRMSDRotationalMatrix()</span></code></a>).
When using this module in published work please cite <a class="reference internal" href="../lib/qcprot.html#theobald2005" id="id14">[Theobald2005]</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../topology_modules.html" title="4. Topology modules"
             >next</a> |</li>
        <li class="right" >
          <a href="waterdynamics.html" title="3.8.3. Water dynamics analysis — MDAnalysis.analysis.waterdynamics"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">MDAnalysis 0.15.1-dev0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../analysis_modules.html" >3. Analysis modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2005-2015, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Balasubramanian, Jonathan Barnoud, Alejandro Bernardin, Bart Bruininks, Sébastien Buchoux, David Caplan, Matthieu Chavent, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Benjamin Hall, Kyle J. Huston, Joe Jordan, Max Linke, Jinju Lu, Robert McGibbon, Manuel Nuno Melo, Fiona Naughton, Alex Nesterenko, Hai Nguyen, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Tyler Reddy, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Andy Somogyi, Caio S. Souza, Lukas Stelzl, Gorman Stock, Isaac Virshup, Zhuyi Xue, and Oliver Beckstein.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.
    </div>
  </body>
</html>